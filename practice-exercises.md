好的！以下是一些更具实战性的 Hive SQL 题目，模拟真实的数据分析与数据挖掘场景，适合你作为实习生进一步提升技能。这些题目强调 **业务理解、数据建模、复杂查询逻辑、异常检测、趋势分析** 等方面。

---

## 🧪 Hive SQL 实战题集（共 5 个场景）

---

### **场景一：员工绩效分析**

假设你有以下两个表：

- `employees(id, name, dept_id, join_date, salary)`
- `performance(id, year, rating)` —— 员工每年的绩效评分（1~5）

#### 题目：

1. 查询每位员工最近一年的绩效评分。
2. 查询连续两年绩效评分为 5 的员工。
3. 查询每个部门的平均绩效评分（按年统计）。
4. 查询绩效评分为 1 的员工，并统计他们的工资是否低于部门平均水平。
5. 查询绩效评分提升最多的员工（比较最近两年）。

---

### **场景二：用户行为分析**

假设你有一个用户行为表：

- `user_actions(user_id, action_type, action_time)`  
  其中 `action_type` 包括：`login`, `purchase`, `comment`, `logout`

#### 题目：

6. 查询每天的活跃用户数（有 login 行为的用户）。
7. 查询每位用户的首次购买时间。
8. 查询用户在登录后 1 小时内完成购买的比例。
9. 查询连续三天都有登录行为的用户。
10. 查询每种行为的日均发生次数。

---

### **场景三：电商订单分析**

假设你有以下表：

- `orders(order_id, user_id, order_date, amount, status)`  
- `products(product_id, category, price)`  
- `order_items(order_id, product_id, quantity)`

#### 题目：

11. 查询每个用户的总订单金额。
12. 查询每个商品类别的销售总额。
13. 查询退货订单（status = 'returned'）的比例。
14. 查询每月的订单增长率。
15. 查询购买最多的商品（按数量统计）。

---

### **场景四：数据质量与异常检测**

假设你正在清洗一个客户数据表：

- `customers(id, name, email, age, signup_date)`

#### 题目：

16. 查询重复的邮箱地址。
17. 查询年龄字段中异常值（如 < 10 或 > 100）。
18. 查询注册日期为空或格式错误的记录。
19. 使用正则表达式筛选出非法邮箱格式。
20. 查询每月新增客户数，并识别增长异常的月份。

---

### **场景五：趋势与预测准备**

假设你有一个销售记录表：

- `sales(date, region, product_id, quantity, revenue)`

#### 题目：

21. 查询每个地区每月的销售总额。
22. 查询销售额同比增长率（今年 vs 去年）。
23. 查询销售额环比增长率（本月 vs 上月）。
24. 查询销售额连续三个月增长的产品。
25. 查询销售额下降超过 30% 的地区和月份。

---

如果你希望我为这些题目提供参考答案与解析，或者将它们整理成 Markdown 或 PDF 文件，我可以立即帮你完成。你想接下来做什么？