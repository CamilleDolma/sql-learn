# Hive SQL 基础习题集

以下是 Hive SQL 的基础练习题，共分为 8 个模块，涵盖语法、聚合、连接、窗口函数、子查询、数据清洗、分区与桶表、性能优化等方面。

---

## 模块一：基础语法与数据类型

1. 创建一个名为 `employees` 的表，包含以下字段：
   - `id`（INT）
   - `name`（STRING）
   - `age`（INT）
   - `salary`（FLOAT）
   - `join_date`（DATE）

2. 向 `employees` 表插入 5 条模拟数据。

3. 查询所有员工的姓名和工资。

4. 查询年龄大于 30 岁的员工信息。

5. 使用 `LIKE` 查询姓名中包含 “li” 的员工。

---

## 模块二：聚合函数与分组

6. 查询每个年龄段的员工数量。

7. 查询员工的平均工资、最高工资和最低工资。

8. 查询工资总和大于 10000 的年龄段。

9. 使用 `HAVING` 筛选平均工资大于 5000 的分组。

---

## 模块三：连接操作（JOIN）

10. 创建一个 `departments` 表，包含字段：
    - `dept_id`（INT）
    - `dept_name`（STRING）

11. 在 `employees` 表中添加 `dept_id` 字段，并插入相应数据。

12. 使用 `INNER JOIN` 查询员工及其所属部门名称。

13. 使用 `LEFT JOIN` 查询所有员工及其部门信息（包括没有部门的员工）。

14. 使用 `RIGHT JOIN` 查询所有部门及其员工信息（包括没有员工的部门）。

---

## 模块四：窗口函数（Window Functions）

15. 查询每位员工的工资排名（按部门分组）。

16. 查询每位员工的平均工资（按部门分组）。

17. 查询每位员工与部门内最高工资的差值。

---

## 模块五：子查询与嵌套查询

18. 查询工资高于公司平均工资的员工。

19. 查询工资最高的员工姓名。

20. 查询每个部门工资最高的员工信息。

---

## 模块六：数据清洗与转换

21. 使用 `CASE WHEN` 将员工年龄分为 “青年”、“中年”、“老年”。

22. 使用 `COALESCE` 处理空值工资字段。

23. 使用 `REGEXP` 提取姓名中的字母部分。

24. 使用 `CAST` 将工资字段转换为整数。

---

## 模块七：分区与桶表

25. 创建一个按 `dept_id` 分区的员工表。

26. 创建一个按 `age` 桶分的员工表，设定为 4 个桶。

27. 查询某个分区中的数据。

28. 查询某个桶中的数据。

---

## 模块八：性能优化与实际应用

29. 使用 `EXPLAIN` 查看某条查询语句的执行计划。

30. 编写一个查询，统计每个部门的员工数量和平均工资，并按平均工资降序排列。
